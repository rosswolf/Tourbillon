#!/usr/bin/env node

/**
 * Claude Code hook to prevent editing auto-generated JSON files
 * Install as: on-file-edit hook
 */

const AUTO_GENERATED_FILES = [
  'mob_data.json',
  'card_data.json', 
  'wave_data.json',
  'goals_data.json',
  'configuration_data.json'
];

const SHEETS_URLS = {
  'mob_data.json': 'https://docs.google.com/spreadsheets/d/1TlOn39AXlw0y2tlkE4kvIpvoZ9SpNQTkDGgOptvqSgM/edit',
  'card_data.json': 'https://docs.google.com/spreadsheets/d/1zoNrBnX2od6nrTL3G4wS_QMYig69laRn0XYH-KOUqTk/edit'
};

// Check if the file being edited is auto-generated
const filepath = process.env.CLAUDE_EDITING_FILE;
if (filepath) {
  const filename = filepath.split('/').pop();
  
  if (AUTO_GENERATED_FILES.includes(filename)) {
    console.error(`
⚠️  WARNING: ${filename} is AUTO-GENERATED from Google Sheets!
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
❌ DO NOT EDIT THIS FILE DIRECTLY - Changes will be lost!

✅ CORRECT WORKFLOW:
1. Edit the Google Sheets spreadsheet:
   ${SHEETS_URLS[filename] || 'Check CLAUDE.md for URL'}

2. Run the sync script:
   cd elastic-app/app/src/scenes/data
   python3 json_exporter.py

📖 See: elastic-app/app/src/scenes/data/CLAUDE.md
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`);
    process.exit(1); // Block the edit
  }
}